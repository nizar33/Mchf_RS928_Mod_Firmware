/*  -*-  mode: c; tab-width: 4; indent-tabs-mode: t; c-basic-offset: 4; coding: utf-8  -*-  */
/************************************************************************************
**                                                                                 **
**                               mcHF QRP Transceiver                              **
**                             K Atanassov - M0NKA 2014                            **
**                                                                                 **
**---------------------------------------------------------------------------------**
**                                                                                 **
**  File name:                                                                     **
**  Description:                                                                   **
**  Last Modified:                                                                 **
**  License:		GNU GPLv3                                                      **
************************************************************************************/

#include "filters.h"

/**************************************************************

KA7OEI, November, 2014

IMPORTANT NOTE:

This is a MINIMAL FIR Lowpass filter that is applied to the RX input
decimation.  It is NOT designed to provide any significant filtering!

The majority of anti-aliasing for this decimation operation is provided BY the
Phase-Added Hilbert Transformer that PRECEDES this!

This is an absolutely minimized operation to reduce processor overhead!

Response:

DC-2370 Hz:  >=-0.25dB
-1dB @ 3492 Hz
-3dB @ 5320 Hz
-6dB @ 6958 Hz
-10dB @ 8396 Hz
Notch @ 10767 Hz with -20dB points at 10000 and 11598 Hz.
Min. -7.6dB @ 16.4 kHz
-20dB > 22.9 kHz



***************************************************************/

const arm_fir_decimate_instance_f32 FirRxDecimate =
{
    .numTaps = 4,
    .pCoeffs = (float*) (const float[])
    {
        -0.3105711170561,
        -0.2100034101786,
        -0.2099936469089,
        -0.3105557871709
    }
};

// this is the decimation filter used for decimating the I and the Q path
// when in CW/SSB mode and filter BW <= 3k6
// 48ksps, 43 taps
// Fc=3.6kHz 0.1500
// Kaiser Beta 2.20, "Raised Cosine"  0.750

/*
const arm_fir_decimate_instance_f32 FirRxDecimate_sideband_supp =
{
    .numTaps = 43,
    .pCoeffs = (float*) (const float[])
    {
        -596.2286796599541960E-6,-927.3655504344595780E-6,-940.6330523057968090E-6,-298.4871913266846950E-6, 0.001186311749146407, 0.003340717388857422, 0.005503534826465819, 0.006586352026602872, 0.005378691189561175, 0.001056745384724361,-0.006253091035763602,-0.015078013363837874,-0.022588392594615103,-0.025094197603292432,-0.018999101368626720,-0.001976514919694041, 0.025998282705991884, 0.062138450304126999, 0.101110564031515582, 0.136092352983227610, 0.160375863194488072, 0.169067382812500000, 0.160375863194488072, 0.136092352983227610, 0.101110564031515582, 0.062138450304126999, 0.025998282705991884,-0.001976514919694041,-0.018999101368626720,-0.025094197603292432,-0.022588392594615103,-0.015078013363837874,-0.006253091035763602, 0.001056745384724361, 0.005378691189561175, 0.006586352026602872, 0.005503534826465819, 0.003340717388857422, 0.001186311749146407,-298.4871913266846950E-6,-940.6330523057968090E-6,-927.3655504344595780E-6,-596.2286796599541960E-6
    }
};
*/

///***********************************************************************************************************
/// NIZZZ developp� le 05 janvier 2021 avec Lowa Hills FIR Filter designer v7.0 pour avoir 6db d'attenuation de plus sur les aubes att�nu�s
/// // this is the decimation filter used for decimating the I and the Q path
// when in CW/SSB mode and filter BW <= 3k6
// 48ksps, 43 taps
// Fc = 3.6kHz 0.1500
// Window OFF, "PARKS MC Clellan"  Transition width = 0.160
/*

const arm_fir_decimate_instance_f32 FirRxDecimate_sideband_supp =
{
    .numTaps = 43,
    .pCoeffs = (float*) (const float[])
    {
    	-449.9800600373518480E-6,
    	-581.4724137308880930E-6,
    	-499.6720309741212420E-6,
    	 175.4660418826538830E-6,
    	 0.001606571829876965,
    	 0.003625358055464734,
    	 0.005604728147894486,
    	 0.006507461066316074,
    	 0.005171542660368608,
    	 798.1196562165770270E-6,
    	-0.006492755361487983,
    	-0.015260034039737002,
    	-0.022714098041731946,
    	-0.025192601692568171,
    	-0.019100728727179141,
    	-0.002090090841913710,
    	 0.025897564423414534,
    	 0.062098988197018014,
    	 0.101179759365353408,
    	 0.136289247553521425,
    	 0.160675616871253923,
    	 0.169406681244897439,
    	 0.160675616871253923,
    	 0.136289247553521425,
    	 0.101179759365353408,
    	 0.062098988197018014,
    	 0.025897564423414534,
    	-0.002090090841913710,
    	-0.019100728727179141,
    	-0.025192601692568171,
    	-0.022714098041731946,
    	-0.015260034039737002,
    	-0.006492755361487983,
    	 798.1196562165770270E-6,
    	 0.005171542660368608,
    	 0.006507461066316074,
    	 0.005604728147894486,
    	 0.003625358055464734,
    	 0.001606571829876965,
    	 175.4660418826538830E-6,
    	-499.6720309741212420E-6,
    	-581.4724137308880930E-6,
    	-449.9800600373518480E-6
     }
};
*/


///***********************************************************************************************************
/// NIZZZ developp� le 15 mai 2021 avec Lowa Hills FIR Filter designer v7.0 pour avoir 10db d'attenuation de plus sur 6khz
/// // this is the decimation filter used for decimating the I and the Q path
// when in CW/SSB mode and filter BW <= 3k6
// 48ksps, 43 taps
// Fc = 3.55 kHz 0.1479
// Window OFF, "PARKS MC Clellan"  Transition width = 0.150

/*
const arm_fir_decimate_instance_f32 FirRxDecimate_sideband_supp =
{
    .numTaps = 43,
    .pCoeffs = (float*) (const float[])
    {
    	-554.5765085166824520E-6,
    	-559.8971700503047940E-6,
    	-307.0347266162650040E-6,
    	 612.1597317516961990E-6,
    	 0.002273198820132338,
    	 0.004384354335740743,
    	 0.006211759506497885,
    	 0.006686363096613565,
    	 0.004729308429881452,
    	-264.3447064574095290E-6,
    	-0.007929124910670967,
    	-0.016623350513770761,
    	-0.023498345623217811,
    	-0.025024932501760962,
    	-0.017908598517144259,
    	-170.6770847955055500E-6,
    	 0.027947818292139562,
    	 0.063583565391468547,
    	 0.101554384496032268,
    	 0.135375554203698012,
    	 0.158743881998626407,
    	 0.167088940174809852,
    	 0.158743881998626407,
    	 0.135375554203698012,
    	 0.101554384496032268,
    	 0.063583565391468547,
    	 0.027947818292139562,
    	-170.6770847955055500E-6,
    	-0.017908598517144259,
    	-0.025024932501760962,
    	-0.023498345623217811,
    	-0.016623350513770761,
    	-0.007929124910670967,
    	-264.3447064574095290E-6,
    	 0.004729308429881452,
    	 0.006686363096613565,
    	 0.006211759506497885,
    	 0.004384354335740743,
    	 0.002273198820132338,
    	 612.1597317516961990E-6,
    	-307.0347266162650040E-6,
    	-559.8971700503047940E-6,
    	-554.5765085166824520E-6
     }
};
*/

///***********************************************************************************************************
/// NIZZZ developp� le 16 mai 2021 avec Lowa Hills FIR Filter designer v7.0 pour avoir 12db d'attenuation de plus sur 6khz
/// // this is the decimation filter used for decimating the I and the Q path
// when in CW/SSB mode and filter BW <= 3k6
// 48ksps, 43 taps
// Fc=3.502 kHz (0.1459) Low pass filter
// Window OFF, "PARKS MC Clellan"  Transition width = 0.155

/*
const arm_fir_decimate_instance_f32 FirRxDecimate_sideband_supp =
{
    .numTaps = 43,
    .pCoeffs = (float*) (const float[])
    {
    	-447.4360876945220300E-6,
    	-403.2164931315904260E-6,
    	-101.5671962025065510E-6,
    	 806.9405418255198580E-6,
    	 0.002362860181042298,
    	 0.004264418686847150,
    	 0.005806240365256087,
    	 0.005988875174420612,
    	 0.003830870884912898,
    	-0.001176527268475489,
    	-0.008607376058468392,
    	-0.016828076311026379,
    	-0.023075689290129736,
    	-0.023972892001704466,
    	-0.016405794310999030,
    	 0.001451475092428789,
    	 0.029285507279507718,
    	 0.064268705145747437,
    	 0.101366952887518139,
    	 0.134315644256690570,
    	 0.157041976791722410,
    	 0.165151972999671104,
    	 0.157041976791722410,
    	 0.134315644256690570,
    	 0.101366952887518139,
    	 0.064268705145747437,
    	 0.029285507279507718,
    	 0.001451475092428789,
    	-0.016405794310999030,
    	-0.023972892001704466,
    	-0.023075689290129736,
    	-0.016828076311026379,
    	-0.008607376058468392,
    	-0.001176527268475489,
    	 0.003830870884912898,
    	 0.005988875174420612,
    	 0.005806240365256087,
    	 0.004264418686847150,
    	 0.002362860181042298,
    	 806.9405418255198580E-6,
    	-101.5671962025065510E-6,
    	-403.2164931315904260E-6,
    	-447.4360876945220300E-6
     }
};
*/


///***********************************************************************************************************
/// NIZZZ developpe le 28 oct 2022 avec Lowa Hills FIR Filter designer v7.0 pour avoir 12db d'attenuation de plus sur 6khz
/// // this is the decimation filter used for decimating the I and the Q path from 48Khz -->> 12Khz ( 4 fois)
// when in CW/SSB mode and filter BW <= 3k6
// 48ksps, 43 taps
// Fc=3.502 kHz (0.1459) Low pass filter  (-66db attenuation après 6Khz )
// Window OFF, "PARKS MC Clellan"  Transition width = 0.153


const  arm_fir_decimate_instance_f32  FirRxDecimate_sideband_supp =
{
    .numTaps = 43,
    .pCoeffs = (float*) (const float[])
    {
    	-473.5023437769243060E-6,
    	-415.6676839640113030E-6,
    	-96.26498539584599710E-6,
    	 845.2036179088617020E-6,
    	 0.002442040020640087,
    	 0.004378270485272343,
    	 0.005932540529115304,
    	 0.006094499357578995,
    	 0.003882267217757418,
    	-0.001199899951141600,
    	-0.008704393925037931,
    	-0.016972587137597694,
    	-0.023225770070829665,
    	-0.024085266378133984,
    	-0.016450813443662039,
    	 0.001478724966734696,
    	 0.029363232048484438,
    	 0.064360763765096390,
    	 0.101436674884875969,
    	 0.134342130041647551,
    	 0.157029312134239346,
    	 0.165122889551088697,
    	 0.157029312134239346,
    	 0.134342130041647551,
    	 0.101436674884875969,
    	 0.064360763765096390,
    	 0.029363232048484438,
    	 0.001478724966734696,
    	-0.016450813443662039,
    	-0.024085266378133984,
    	-0.023225770070829665,
    	-0.016972587137597694,
    	-0.008704393925037931,
    	-0.001199899951141600,
    	 0.003882267217757418,
    	 0.006094499357578995,
    	 0.005932540529115304,
    	 0.004378270485272343,
    	 0.002442040020640087,
    	 845.2036179088617020E-6,
    	-96.26498539584599710E-6,
    	-415.6676839640113030E-6,
    	-473.5023437769243060E-6
     }
};






const arm_fir_decimate_instance_f32 FirZoomFFTDecimate[] =
{
        {
                .numTaps = 4,
                .pCoeffs = (float*) (const float[])
                {
                    -0.3105711170561,
                    -0.2100034101786,
                    -0.2099936469089,
                    -0.3105557871709
                }
        },
        // 48ksps, 12kHz lowpass
        {
                .numTaps = 4,
                .pCoeffs = (float*) (const float[])
                {
                    475.1179397144384210E-6,
                    0.503905202786044337,
                    0.503905202786044337,
                    475.1179397144384210E-6
                }
        },
        // 48ksps, 6kHz lowpass
        {
                .numTaps = 4,
                .pCoeffs = (float*) (const float[])
                {
                    0.198273254218889416,
                    0.298085149879260325,
                    0.298085149879260325,
                    0.198273254218889416
                }
        },
        // 48ksps, 3kHz lowpass
        {
                .numTaps = 4,
                .pCoeffs = (float*) (const float[])
                {
                    0.199820836596682871,
                    0.272777397353925699,
                    0.272777397353925699,
                    0.199820836596682871
                }
        },
        // 48ksps, 1.5kHz lowpass
        {
                .numTaps = 4,
                .pCoeffs = (float*) (const float[])
                {
                    0.199820836596682871,
                    0.272777397353925699,
                    0.272777397353925699,
                    0.199820836596682871
                }
        },
        // 48ksps, 750Hz lowpass
        {
                .numTaps = 4,
                .pCoeffs = (float*) (const float[])
                {
                    0.199820836596682871,
                    0.272777397353925699,
                    0.272777397353925699,
                    0.199820836596682871
                }
        }
};



